<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BusSight ‚Ä¢ Contagem de pessoas</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body class="bg">
  <header class="topbar">
    <div class="container">
      <div class="brand">
        <img src="/static/design.svg" alt="BusSight" class="brand-logo" />
        <div>
          <h1>BusSight ‚Ä¢ Contagem de pessoas</h1>
          <small>Entradas e sa√≠das por linha virtual</small>
        </div>
      </div>
    </div>
  </header>

  <main class="container grid">
    <!-- Painel de upload / par√¢metros -->
    <section class="card">
      <h2>V√≠deo e Par√¢metros</h2>

      <form id="formUpload">
        <div class="field">
          <div class="label-row">
            <label for="video">V√≠deo (MP4)</label>
            <span class="help">Dica: foque a porta do √¥nibus para melhor precis√£o</span>
          </div>
          <input type="file" id="video" name="video" accept="video/mp4,video/*" required />
        </div>

        <div class="field">
          <div class="label-row">
            <label>Linha de contagem</label>
            <span class="help">Clique 2√ó no preview para definir | valores normalizados 0‚Äì1</span>
          </div>
          <div class="row gap">
            <div class="col"><input type="number" step="0.001" min="0" max="1" id="x1" name="x1" value="0.10" aria-label="x1"></div>
            <div class="col"><input type="number" step="0.001" min="0" max="1" id="y1" name="y1" value="0.55" aria-label="y1"></div>
            <div class="col"><input type="number" step="0.001" min="0" max="1" id="x2" name="x2" value="0.90" aria-label="x2"></div>
            <div class="col"><input type="number" step="0.001" min="0" max="1" id="y2" name="y2" value="0.55" aria-label="y2"></div>
          </div>
        </div>

        <div class="preview" id="dropArea">
          <video id="videoPreview" controls playsinline></video>
          <canvas id="overlay"></canvas>
          <!-- reposicionada e mais leg√≠vel -->
          <div class="overlay-hint">üí° Dica: clique e arraste a linha ou as pontas para ajustar</div>
        </div>

        <details class="card subtle">
          <summary>Op√ß√µes avan√ßadas</summary>
          <div class="grid-2">
            <div class="field">
              <label for="sample_fps">Sample FPS</label>
              <input type="number" step="0.5" min="0.5" id="sample_fps" name="sample_fps" value="5.0">
            </div>
            <div class="field">
              <label for="chunk_seconds">Chunk (s)</label>
              <input type="number" min="10" id="chunk_seconds" name="chunk_seconds" value="60">
            </div>
            <div class="field">
              <label for="workers">Workers (CPU)</label>
              <input type="number" min="0" id="workers" name="workers" value="0">
            </div>
            <div class="field">
              <label class="label-row" for="save_annotated">
                <span>Salvar v√≠deo anotado</span>
              </label>
              <input type="checkbox" id="save_annotated" name="save_annotated" checked>
            </div>
          </div>
        </details>

        <div class="actions">
          <button type="button" id="btnProcess" class="btn primary">Processar</button>
          <button type="button" id="btnStream" class="btn outline">Processar (Streaming)</button>
        </div>
      </form>
    </section>

    <!-- Painel de status/resultados -->
    <!-- Painel de status/resultados -->
<section class="card">
  <h2>Status & Resultados</h2>

  <!-- status j√° como se tivesse conclu√≠do -->
  <div id="status" class="status" data-state="ok">
    ‚úÖ Processamento conclu√≠do em 3min 24s
  </div>

  <div id="results" class="results">
    <div class="numbers">
      <div class="pill in"><span id="inCount">128</span><small>Entraram</small></div>
      <div class="pill out"><span id="outCount">95</span><small>Sa√≠ram</small></div>
    </div>

    <div id="downloads" class="downloads">
      <a href="#">‚¨á Relat√≥rio CSV</a>
      <a href="#" class="secondary">‚¨á V√≠deo anotado</a>
    </div>

    <div id="windowsWrap" class="windows">
      <h3>Agregado por janelas</h3>
      <div class="table-wrap">
        <table id="windowsTable" aria-label="Tabela de janelas">
          <thead>
            <tr><th>Janela</th><th>IN</th><th>OUT</th></tr>
          </thead>
          <tbody>
            <tr><td>00:00‚Äì05:00</td><td>23</td><td>15</td></tr>
            <tr><td>05:00‚Äì10:00</td><td>41</td><td>36</td></tr>
            <tr><td>10:00‚Äì15:00</td><td>35</td><td>28</td></tr>
            <tr><td>15:00‚Äì20:00</td><td>29</td><td>16</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div id="annotatedWrap" class="video-out">
      <h3>V√≠deo anotado</h3>
      <video id="annotatedVideo" controls>
        <source src="/video1.mp4" type="video/mp4">
      </video>
    </div>
  </div>
</section>

  </main>

  <footer class="footer">
    <div class="container">
      <span>BusSight ‚Ä¢ Contagem de pessoas</span>
    </div>
  </footer>

  <script src="/static/app.js"></script>
  <script>
    // (opcional) melhorias de UX no drop/preview sem mudar sua l√≥gica
    const drop = document.getElementById('dropArea');
    const file = document.getElementById('video');
    ['dragenter','dragover'].forEach(e=>drop.addEventListener(e,(ev)=>{ev.preventDefault();drop.classList.add('is-active')}))
    ;['dragleave','drop'].forEach(e=>drop.addEventListener(e,(ev)=>{ev.preventDefault();drop.classList.remove('is-active')}))
    drop.addEventListener('drop', (ev)=>{
      if(ev.dataTransfer?.files?.length){
        file.files = ev.dataTransfer.files; file.dispatchEvent(new Event('change',{bubbles:true}));
      }
    });
  </script>
</body>
</html>
